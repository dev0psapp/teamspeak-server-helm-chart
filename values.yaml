# Default values for teamspeak
replicaCount: 1

image:
  repository: docker.io/teamspeak/ts3server
  pullPolicy: IfNotPresent
  tag: "latest"

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

# Service Account
serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

# TeamSpeak Server Configuration
teamspeak:
  # License acceptance - REQUIRED: set to "accept" to accept the TeamSpeak license
  license: ""

  # Server display name
  serverName: "My TeamSpeak Server"

  # Server password (leave empty for no password - NOT RECOMMENDED for production)
  serverPassword: ""

  # ServerQuery admin username
  serverAdmin: "serveradmin"

  # ServerQuery admin password (auto-generated if empty)
  serverQueryPassword: ""

  # Default voice port (default: 9987)
  defaultVoicePort: ""

  # Query whitelist (comma-separated IPs, e.g., "127.0.0.1,192.168.1.1")
  queryWhitelist: ""

  # Query blacklist (comma-separated IPs)
  queryBlacklist: ""

  # Additional environment variables (key-value pairs)
  # See: https://teamspeak.com/en/downloads/#server
  extraEnv: []
  # Example:
  # - name: TS3SERVER_QUERY_PROTOCOLS
  #   value: "raw,ssh"
  # - name: TS3SERVER_DB_SQLCREATEPATH
  #   value: "create_sqlite"

# Service configuration
service:
  type: LoadBalancer
  # DNS hostname for the service (for external-dns)
  hostname: ""
  # Example: "ts.dev0ps.app"
  
  # Fixed IP address (optional)
  loadBalancerIP: ""
  
  # Service annotations (for external-dns, metallb, cloud providers)
  annotations: {}
  # Example annotations:
  # external-dns.alpha.kubernetes.io/hostname: ts.dev0ps.app
  # metallb.universe.tf/address-pool: default
  
  # Voice port (UDP) - main TeamSpeak port
  voice:
    port: 9987
    protocol: UDP
    nodePort: null
  
  # ServerQuery port (TCP) - admin interface
  serverquery:
    port: 10011
    protocol: TCP
    nodePort: null
  
  # FileTransfer port (TCP) - file uploads/downloads
  filetransfer:
    port: 30033
    protocol: TCP
    nodePort: null

# Ingress for TCP ports (optional, for ServerQuery and FileTransfer)
ingress:
  enabled: false
  className: ""
  annotations: {}
    # cert-manager.io/cluster-issuer: letsencrypt-prod
    # nginx.ingress.kubernetes.io/ssl-redirect: "true"
  
  # Hostname for ingress
  host: ""
  # Example: ts.dev0ps.app
  
  tls:
    enabled: false
    secretName: ""

# Persistence for TeamSpeak data
persistence:
  enabled: true
  storageClass: ""
  accessMode: ReadWriteOnce
  size: 5Gi
  existingClaim: ""
  annotations: {}

# Resource limits
resources:
  limits:
    cpu: 1000m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 128Mi

nodeSelector: {}
tolerations: []
affinity: {}
podAnnotations: {}

podSecurityContext:
  fsGroup: 9987
  # Uncomment for stricter security
  # runAsNonRoot: true
  # seccompProfile:
  #   type: RuntimeDefault

securityContext:
  runAsUser: 9987
  runAsNonRoot: true
  # Recommended: Enable these for enhanced security
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
  # Note: readOnlyRootFilesystem requires TeamSpeak to use tmpfs/emptyDir for temp files
  # readOnlyRootFilesystem: true

# Health checks (using ServerQuery TCP port)
livenessProbe:
  tcpSocket:
    port: serverquery
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  tcpSocket:
    port: serverquery
  initialDelaySeconds: 10
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3
